# üîê –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –≤ ApiAi

## –û–±–∑–æ—Ä

ApiAi –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç **End-to-End —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ** –¥–ª—è –∑–∞—â–∏—Ç—ã AI –∑–∞–ø—Ä–æ—Å–æ–≤ –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å Telegram Bot API.

**–¢–µ—Ö–Ω–æ–ª–æ–≥–∏—è:** AES-256-GCM (—á–µ—Ä–µ–∑ –±–∏–±–ª–∏–æ—Ç–µ–∫—É `cryptography`)

---

## –†–µ–∞–ª–∏–∑–∞—Ü–∏—è

## –†–µ–∞–ª–∏–∑–∞—Ü–∏—è

### –ú–æ–¥—É–ª—å —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è (`shared-rs/src/encryption.rs`)

–°—Ç—Ä—É–∫—Ç—É—Ä–∞ `SecureMessenger` (Rust) –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç:
- ‚úÖ –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ Telegram Bot
- ‚úÖ –†–∞—Å—à–∏—Ñ—Ä–æ–≤–∫—É –æ—Ç–≤–µ—Ç–æ–≤
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫—É —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö (ChaCha20-Poly1305 / AES-256-GCM)
- ‚úÖ –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å Python —Å–µ—Ä–≤–µ—Ä–æ–º

**–ü—Ä–∏–Ω—Ü–∏–ø —Ä–∞–±–æ—Ç—ã:**
1. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —É–Ω–∏–∫–∞–ª—å–Ω–æ–≥–æ Nonce (12 –±–∞–π—Ç) –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞
2. –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ payload —á–µ—Ä–µ–∑ ChaCha20-Poly1305
3. –§–æ—Ä–º–∞—Ç –ø–∞–∫–µ—Ç–∞: `[Nonce][Ciphertext][Tag]`
4. Base64 –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –ø–µ—Ä–µ–¥–∞—á–∏

### –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ Tauri (`tauri-app/src-tauri/src/lib.rs`)

Tauri backend –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `shared-rs` –¥–ª—è —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è:

```rust
// tauri-app/src-tauri/src/lib.rs
let client = TelegramClient::new(
    url,
    api_key,
    encryption_key, // Option<String>
    use_encryption  // bool
);
```

**Endpoint mapping:**
- –ë–µ–∑ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è: `/ai_query`
- –° —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ–º: `/ai_query/secure`

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (`config.json`)

```json
{
  "api_keys": {
    "telegram_url": "http://server:8000/ai_query",
    "telegram_key": "api-key-here",
    "telegram_enc_key": "hex-encryption-key-64-chars",
    "telegram_use_encryption": true
  }
}
```

**–ü–æ–ª—è:**
- `telegram_url` ‚Äî URL —Å–µ—Ä–≤–µ—Ä–∞ TelegramHelper
- `telegram_key` ‚Äî API –∫–ª—é—á –¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ (X-API-KEY)
- `telegram_enc_key` ‚Äî –ö–ª—é—á —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è (hex, 64 —Å–∏–º–≤–æ–ª–∞ = 256 –±–∏—Ç)
- `telegram_use_encryption` ‚Äî –í–∫–ª—é—á–∏—Ç—å/–≤—ã–∫–ª—é—á–∏—Ç—å —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ

### App Whitelist & APP_ID

–°–µ—Ä–≤–µ—Ä TelegramHelper –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–∏—Å—Ç–µ–º—É **–±–µ–ª–æ–≥–æ —Å–ø–∏—Å–∫–∞ (whitelist)** –¥–ª—è –∫–æ–Ω—Ç—Ä–æ–ª—è –¥–æ—Å—Ç—É–ø–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π.

**–ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:**
1. –ö–∞–∂–¥–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∑–∞–≥–æ–ª–æ–≤–æ–∫ `X-APP-ID`.
2. –°–µ—Ä–≤–µ—Ä –ø—Ä–æ–≤–µ—Ä—è–µ—Ç, –µ—Å—Ç—å –ª–∏ —ç—Ç–æ—Ç ID –≤ —Å–ø–∏—Å–∫–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–Ω—ã—Ö (`ALLOWED_APPS`).
3. –ï—Å–ª–∏ ID —Ä–∞–∑—Ä–µ—à–µ–Ω, —Å–µ—Ä–≤–µ—Ä –ø—Ä–∏–º–µ–Ω—è–µ—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ –ª–∏–º–∏—Ç—ã (rate limits) –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏.

**–í—ã—á–∏—Å–ª–µ–Ω–∏–µ APP_ID:**
–í ApiAi (Rust/Tauri) `APP_ID` –≤—ã—á–∏—Å–ª—è–µ—Ç—Å—è **–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏** –Ω–∞ –æ—Å–Ω–æ–≤–µ –º–∞–∂–æ—Ä–Ω–æ–π –≤–µ—Ä—Å–∏–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:
- –í–µ—Ä—Å–∏—è `2.x.x` ‚Üí `apiai-v2`
- –í–µ—Ä—Å–∏—è `3.x.x` ‚Üí `apiai-v3`

–≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç —Å–µ—Ä–≤–µ—Ä—É –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å —Ä–∞–∑–Ω—ã–µ –≤–µ—Ä—Å–∏–∏ –∫–ª–∏–µ–Ω—Ç–æ–≤ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ.

---

## –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

### –°—Ü–µ–Ω–∞—Ä–∏–π: AI –ø–æ–∏—Å–∫ —Å —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ–º

1. **ApiAi (–ö–ª–∏–µ–Ω—Ç):**
   - –°–æ–∑–¥–∞–µ—Ç `SecureMessenger` —Å –∫–ª—é—á–æ–º –∏–∑ –∫–æ–Ω—Ñ–∏–≥–∞
   - –§–æ—Ä–º–∏—Ä—É–µ—Ç payload: `{"prompt": "...", "provider": "anthropic"}`
   - –®–∏—Ñ—Ä—É–µ—Ç —á–µ—Ä–µ–∑ `messenger.encrypt()`
   - –ö–æ–¥–∏—Ä—É–µ—Ç –≤ Base64
   - –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç POST –Ω–∞ `/ai_query/secure`: `{"data": "base64..."}`

2. **–°–µ—Ç—å:**
   - Wireshark –≤–∏–¥–∏—Ç —Ç–æ–ª—å–∫–æ Base64 —Å—Ç—Ä–æ–∫—É
   - –ü—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–µ —É–∑–ª—ã –Ω–µ –º–æ–≥—É—Ç –ø—Ä–æ—á–∏—Ç–∞—Ç—å —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ

3. **TelegramHelper (–°–µ—Ä–≤–µ—Ä):**
   - –î–µ–∫–æ–¥–∏—Ä—É–µ—Ç Base64
   - –†–∞—Å—à–∏—Ñ—Ä–æ–≤—ã–≤–∞–µ—Ç —Ç–µ–º –∂–µ –∫–ª—é—á–æ–º
   - –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –ø—Ä–æ–º–ø—Ç
   - –®–∏—Ñ—Ä—É–µ—Ç –æ—Ç–≤–µ—Ç –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –æ–±—Ä–∞—Ç–Ω–æ

4. **ApiAi (–ö–ª–∏–µ–Ω—Ç):**
   - –†–∞—Å—à–∏—Ñ—Ä–æ–≤—ã–≤–∞–µ—Ç –æ—Ç–≤–µ—Ç
   - –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é

### –§–æ—Ä–º–∞—Ç –¥–∞–Ω–Ω—ã—Ö

**–ó–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–π –∑–∞–ø—Ä–æ—Å:**
```json
{
  "data": "aGVsbG8gd29ybGQ..."  // Base64-encoded encrypted payload
}
```

**–ó–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–π –æ—Ç–≤–µ—Ç:**
```json
{
  "data": "cmVzcG9uc2UgdGV4dA..."  // Base64-encoded encrypted response
}
```

---

## –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–ª—é—á–∞ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è

### Python (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

```python
import os
key = os.urandom(32).hex()
print(f"Encryption key: {key}")
# –†–µ–∑—É–ª—å—Ç–∞—Ç: 64 hex —Å–∏–º–≤–æ–ª–∞
```

### OpenSSL

```bash
openssl rand -hex 32
```

### –í–∞–∂–Ω–æ

- ‚ö†Ô∏è –û–¥–∏–Ω –∏ —Ç–æ—Ç –∂–µ –∫–ª—é—á –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ –∏ —Å–µ—Ä–≤–µ—Ä–µ
- ‚ö†Ô∏è –ö–ª—é—á –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å **—Ä–æ–≤–Ω–æ 64 hex —Å–∏–º–≤–æ–ª–∞** (32 –±–∞–π—Ç–∞)
- ‚ö†Ô∏è –•—Ä–∞–Ω–∏—Ç–µ –∫–ª—é—á –≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ (–Ω–µ –∫–æ–º–º–∏—Ç—å—Ç–µ –≤ Git)

---

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞
### GUI

1. –û—Ç–∫—Ä–æ–π—Ç–µ ApiAi
2. –ù–∞–∂–º–∏—Ç–µ **"‚öôÔ∏è Settings"** –≤ —Å–∞–π–¥–±–∞—Ä–µ
3. –†–∞–∑–±–ª–æ–∫–∏—Ä—É–π—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ (PIN: 1234)
4. –í —Ä–∞–∑–¥–µ–ª–µ "Telegram Bot API":
   - –í–≤–µ–¥–∏—Ç–µ URL —Å–µ—Ä–≤–µ—Ä–∞
   - –í–≤–µ–¥–∏—Ç–µ API Key
   - –í–≤–µ–¥–∏—Ç–µ Encryption Key (64 hex —Å–∏–º–≤–æ–ª–∞)
   - –í–∫–ª—é—á–∏—Ç–µ "Use Encryption"
5. –ù–∞–∂–º–∏—Ç–µ **"üíæ Save Settings"**

### –í—Ä—É—á–Ω—É—é (config.json)

```json
{
  "api_keys": {
    "telegram_use_encryption": true,
    "telegram_enc_key": "–≤–∞—à-64-—Å–∏–º–≤–æ–ª—å–Ω—ã–π-hex-–∫–ª—é—á"
  }
}
```

---

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

‚úÖ **–ß—Ç–æ –∑–∞—â–∏—â–µ–Ω–æ:**
- –¢–µ–∫—Å—Ç –ø—Ä–æ–º–ø—Ç–æ–≤ –∫ AI
- –û—Ç–≤–µ—Ç—ã –æ—Ç AI
- –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–ø—Ä–æ—Å–æ–≤

‚úÖ **–ß—Ç–æ –ù–ï –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–æ:**
- HTTP –∑–∞–≥–æ–ª–æ–≤–∫–∏ (X-API-KEY, User-Agent)
- URL endpoint
- –†–∞–∑–º–µ—Ä –ø–∞–∫–µ—Ç–∞

‚úÖ **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ HTTPS –¥–ª—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –∑–∞—â–∏—Ç—ã
- –†–µ–≥—É–ª—è—Ä–Ω–æ –º–µ–Ω—è–π—Ç–µ –∫–ª—é—á —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è
- –ù–µ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –æ–¥–∏–Ω –∫–ª—é—á –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Å–µ—Ä–≤–∏—Å–æ–≤

---

## –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å

–®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–≤–º–µ—Å—Ç–∏–º–æ —Å:
- ‚úÖ TelegramHelper (—Å–µ—Ä–≤–µ—Ä —Å –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–µ–π)
- ‚úÖ –õ—é–±–æ–π —Å–µ—Ä–≤–µ—Ä —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π AES-256-GCM

–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:
- Python –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ `cryptography >= 41.0.0`

---

## –û—Ç–ª–∞–¥–∫–∞

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–ª—é—á–∞

```python
from encryption import SecureMessenger

try:
    messenger = SecureMessenger("–≤–∞—à-–∫–ª—é—á-64-symbols")
    test_data = {"test": "hello"}
    encrypted = messenger.encrypt(test_data)
    decrypted = messenger.decrypt(encrypted)
    print("‚úÖ –ö–ª—é—á –≤–∞–ª–∏–¥–µ–Ω")
except Exception as e:
    print(f"‚ùå –û—à–∏–±–∫–∞: {e}")
```

### –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

–ü—Ä–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö —Å —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ–º –ø—Ä–æ–≤–µ—Ä—å—Ç–µ:
1. –î–ª–∏–Ω–∞ –∫–ª—é—á–∞ (–¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å 64 hex —Å–∏–º–≤–æ–ª–∞)
2. –ö–ª—é—á –æ–¥–∏–Ω–∞–∫–æ–≤—ã–π –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ –∏ —Å–µ—Ä–≤–µ—Ä–µ
3. –ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ `cryptography` —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞

---

**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:** 30.11.2025  
**–ê–≤—Ç–æ—Ä:** Kurein M.N.  
**–í–µ—Ä—Å–∏—è:** 1.0
